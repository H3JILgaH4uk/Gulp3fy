@use '../functions/convert' as *;
@use '../utils/forwards' as *;
@use '../mixins/media';

$_duration: 0.5s;
$_ease: cubic-bezier(0.2, 0, 0.3, 1);
$_ease-squish-1: cubic-bezier(0.7, -0.3, 0.1, 1.5);
$_ease-squish-2: cubic-bezier(0.7, -0.5, 0.1, 1.5);

.modal {
	position: fixed;
	inset: 0;

	display: grid;
	inline-size: rem(500);
	max-block-size: min(80vh, 100%);
	max-inline-size: min(90vw, rem(500));
	margin: auto;
	overflow: hidden;

	@include media.max(md) {
		margin-block-end: 0;

		border-end-end-radius: 0;
		border-end-start-radius: 0;
	}

	&::backdrop {
		background-color: $backdropBg;

		animation: fade-up $_duration;
	}

	&:not([open], .--closing) {
		visibility: hidden;
		opacity: 0%;

		pointer-events: none;
	}

	&[open] {
		animation: slide-in-up $_duration $_ease forwards;
	}

	&__wrapper {
		display: grid;
		grid-template-rows: auto 1fr auto;
		align-items: start;
		max-block-size: 80vh;
	}

	&__close {
		place-items: center;
		aspect-ratio: 1;
		padding: rem(8);

		font-size: 0;

		user-select: none;
		stroke: currentcolor;
		stroke-width: rem(3);

		& svg {
			stroke-linecap: round;
			stroke-linejoin: round;
		}
	}

	&__header,
	&__footer {
		display: flex;
		align-items: flex-start;
	}

	&__header {
		gap: rem(16);
		justify-content: space-between;
	}

	&__content {
		display: grid;
		justify-items: flex-start;
		max-block-size: 100%;
		overflow-y: auto;
		overscroll-behavior-y: contain;
	}

	&__footer {
		flex-wrap: wrap;
		justify-content: flex-end;

		&-menu {
			display: flex;
			flex-wrap: wrap;
		}
	}

	&.--closing {
		animation: slide-out-down $_duration $_ease forwards;
		animation-timing-function: $_ease-squish-1;

		@include media.min(md) {
			animation: scale-down $_duration $_ease forwards;
			animation-timing-function: $_ease-squish-2;
		}

		&::backdrop {
			animation: fade-down $_duration linear forwards;
		}
	}
}

@keyframes fade-up {
	from {
		opacity: 0%;
	}
}

@keyframes fade-down {
	to {
		opacity: 0%;
	}
}

@keyframes slide-in-up {
	from {
		transform: translateY(100%);
	}
}

@keyframes scale-down {
	to {
		transform: scale(0.85);
		opacity: 0%;
	}
}

@keyframes slide-out-down {
	to {
		transform: translateY(100%);
	}
}
